<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ginger Summer Invitational</title>
    <link rel="icon" type="image/png" href="logo_transparent.png">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="news-detail.css">
    <link rel="stylesheet" href="signup.css">

    <!-- Popup styles -->
    <style>
        .success-popup {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.45);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .success-popup.visible {
            display: flex;
        }

        .success-popup-box {
            background: #ffffff;
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            max-width: 380px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
        }

        .success-icon {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: 3px solid #2D8B47;
            color: #2D8B47;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin: 0 auto 1rem;
        }

        .success-popup-box p {
            margin-bottom: 1.5rem;
            color: #333;
            font-size: 1rem;
        }

        .success-popup-box.loading .success-icon {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: 3px solid #2D8B47;
            border-top-color: transparent;
            animation: spinner 0.8s linear infinite;
            font-size: 0;
        }

        .success-popup-box.loading .success-message {
            margin-top: 1rem;
        }

        @keyframes spinner {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<script>
    const spotsURL = "https://script.google.com/macros/s/AKfycbzkCLcg3WVGEXNK4u58O2Vv2t-0PQiTxGBYk9slCnqpViNe6dNgmCHnfOBlIe3byKSX/exec";
    const MAX_TEAMS = 15;

    function updateSpotsLeft() {
        const spotsEl = document.getElementById("spotsLeft");
        const submitBtn = document.getElementById("submitBtn");

        if (!spotsEl) return;

        fetch(spotsURL)
            .then(res => res.json())
            .then(data => {
                console.log('Data fr√• Apps Script:', data);

                if (data && typeof data.spotsLeft === 'number') {

                    if (data.spotsLeft <= 0) {
                        // Fullt
                        spotsEl.textContent = `Turneringa er full`;
                        if (submitBtn) {
                            submitBtn.disabled = true;
                            submitBtn.style.backgroundColor = "#888";
                            submitBtn.style.cursor = "not-allowed";
                            submitBtn.textContent = "Fullt";
                        }
                    } else {
                        // Ledige plassar
                        spotsEl.textContent = `${data.spotsLeft} av ${MAX_TEAMS} plassar ledige`;
                        if (submitBtn) {
                            submitBtn.disabled = false;
                            submitBtn.style.backgroundColor = "";
                            submitBtn.style.cursor = "pointer";
                            submitBtn.textContent = "Send inn p√•melding";
                        }
                    }

                } else {
                    spotsEl.textContent = `P√•melding er open`;
                }
            })
            .catch(err => {
                console.error("Feil ved henting av ledige plassar:", err);
                spotsEl.textContent = `P√•melding er open`;
                // Her lar vi knappen vere som normalt
            });
    }

    // Kj√∏r f√∏rst n√•r HTML-en er klar
    window.addEventListener('DOMContentLoaded', updateSpotsLeft);
</script>

<body>
    <!-- Hero Section -->
    <section id="top" class="hero">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <div class="hero-logo">
                <img src="logo_transparent.png" alt="GingerSummer Invitational logo">
            </div>
            <h1>
                Ginger Summer Invitational<br>
                <span class="winter-edition">
                    <img src="julecup.gif" alt="Winter edition" class="winter-gif">
                </span>
            </h1>
            <p style="font-weight: 700;">Velkommen til vestlandets r√•aste simulatorcupturnering 20. desember!</p>
            <a href="#tournament" class="btn-hero">Sj√• turneringsdetaljar</a>
        </div>
    </section>

    <!-- Tournament Info -->
    <section id="tournament" class="news-detail-section">
        <div class="container">
            <article class="news-detail">
                <img src="hero3.png" alt="Ginger Summer Invitational ‚Äì Julecup" class="detail-image">
                <div class="detail-content">
                    <span class="detail-tag">Simulatorcup ¬∑ B√∏rdi golf</span>
                    <span class="detail-date">20. desember 2025 ¬∑ kl. 16:00</span>
                    <h1 class="detail-title">GSI ‚Äì Julecup</h1>
                    <div class="detail-meta">
                        <div class="meta-item">
                            <span class="meta-label">Format</span>
                            <span class="meta-value">2-manns scramble ¬∑ cup</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Stad</span>
                            <span class="meta-value">
                                B√∏rdi Golf ¬∑
                                <a href="https://www.google.com/maps/place/B%C3%98RDI/@61.4563808,5.8365934,538m/data=!3m2!1e3!4b1!4m6!3m5!1s0x461633e4f1085a17:0xc7d8ae5d19396c4f!8m2!3d61.4563808!4d5.8365934!16s%2Fg%2F11y04b59gc!5m1!1e2?entry=ttu"
                                    target="_blank" class="map-button">
                                    Sj√• kart<br>
                                </a>
                            </span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Plassar</span>
                            <span class="meta-value">Maks 15 lag ¬∑ 3 simulatorar</span>
                        </div>
                    </div>

                    <p class="detail-text">
                        Etter ein sommar med full suksess tek vi no festen innand√∏rs hos B√∏rdi golf ‚õ≥Ô∏è
                    </p>

                    <!-- Om turneringa -->
                    <h2 class="detail-subtitle">Om turneringa</h2>
                    <p class="detail-text">
                        Turneringa blir spelt som 2-manns scramble, der de spelar saman som lag p√• kvar einaste slag.
                    </p>
                    <ul class="detail-list">
                        <li>2 spelarar per lag</li>
                        <li>Scramble-format ‚Äì de sl√•r fr√• beste ball kvar gong</li>
                        <li>Cupturnering p√• brutto slag ‚Äì ingen f√•r tildelte slag</li>
                        <li>Maks 15 lag, s√• her l√∏nner det seg √• vere tidleg ute</li>
                    </ul>

                    <div class="detail-divider">
                        <span class="divider-icon">üèÜ</span>
                    </div>

                    <!-- Premier -->
                    <p class="detail-text">
                        <strong>Premier</strong><br>
                        Det skal l√∏nne seg √• spele bra ‚Äì og det skal vere moro √• vere med.<br><br>

                        ‚Ä¢ Premie til 1., 2. og 3. plass<br>
                        ‚Ä¢ Ekstra konkurransar undervegs<br>
                        ‚Ä¢ Trekkepremiar ‚Äì alle lag har sjanse til √• vinne noko<br><br>
                    </p>

                    <!-- Premier Logos Row -->
                    <div class="premier-logos">
                        <img src="logo_marcel.png" alt="Sponsor 1" class="premier-logo-left">
                        <img src="bordilogo.jpg" alt="B√∏rdi Golf" class="premier-logo-right">
                    </div>

                    <!-- Divider icon -->
                    <div class="section-divider">‚õ≥</div>


                    <!-- Sosialt -->
                    <h2 class="detail-subtitle">Sosialt</h2>
                    <p class="detail-text">
                        Dette er minst like mykje ein sosial dag som ein seri√∏s turnering.
                    </p>
                    <ul class="detail-list">
                        <li>Arrangementet kjem til √• vare fleire timar fr√• start til slutt</li>
                        <li>Her er det lov √• drikke og kose seg üçª</li>
                        <li>Det blir tilbod om felles matbestilling (t.d. pizza)</li>
                    </ul>


                    <div class="detail-divider">
                        <span class="divider-icon">üìã</span>
                    </div>

                    <!-- Turneringsoppsett -->
                    <h2 class="detail-subtitle">Turneringsoppsett</h2>
                    <p class="detail-text">
                        Turneringa er bygd opp som gruppespel + sluttspel, slik at alle f√•r mykje speletid.
                    </p>
                    <ul class="detail-list">
                        <li>3 grupper med 5 lag p√• kvar simulator</li>
                        <li>Scramble matchplay over 3 hol mot kvart av dei andre laga i gruppa</li>
                        <li>Poengsystem: 3 poeng for siger, 1 poeng for uavgjort, 0 poeng for tap</li>
                        <li>Vidare til sluttspel: 1.- og 2.-plass i kvar gruppe + dei to beste trearane</li>
                    </ul>
                    <p class="detail-text">
                        I sluttspelet spelar vi:
                    </p>
                    <ul class="detail-list">
                        <li>Kvartfinale, semifinale og bronsefinale: best av 3 hol</li>
                        <li>Finale: best av 5 hol</li>
                    </ul>

                    <div class="signup-cta">
                        <h3>Klar for √• bli med?</h3>
                        <p>Samle ein makker, finn lagnamn og meld dykk p√• turneringa f√∏r plassane fyllast opp.</p>

                        <p id="spotsLeft" style="font-weight:700; margin: 1rem 0; font-size:1.1rem;">
                            Laster ledige plassar...
                        </p>

                        <a href="#signup" class="btn-signup">Sj√• p√•meldingsskjema</a>
                    </div>

                </div>
            </article>
        </div>
    </section>


    <!-- Signup Section -->
    <section id="signup" class="signup-section">
        <div class="container">

            <div class="signup-content">

                <!-- Form only -->
                <div class="signup-form-container">
                    <h2>P√•melding</hh2>

                    <!-- Prisinfo under overskrift -->
                    <form id="signupForm" class="signup-form">
                        <div class="form-group">
                            <label for="lagnamn">Lagnamn:</label>
                            <input type="text" id="lagnamn" name="lagnamn" required>
                        </div>

                        <div class="form-group">
                            <label for="spelar1">Namn (spelar 1):</label>
                            <input type="text" id="spelar1" name="spelar1" required>
                        </div>

                        <div class="form-group">
                            <label for="spelar2">Namn (spelar 2):</label>
                            <input type="text" id="spelar2" name="spelar2" required>
                        </div>

                        <p class="price-info">
                            Pris per person <strong>350,- kroner</strong> (700,- per lag)<br>
                            Betaling gjennom Vipps til <strong>959 40 940</strong> (Eivind)<br><br>
                            <span style="color:#C94D26; font-weight:bold;">NB! <br> P√•meldinga er ikkje fullf√∏rt f√∏r
                                betaling er
                                registrert.</span>
                        </p>

                        <!-- Viktig: id lagt til her -->
                        <button type="submit" id="submitBtn" class="btn-submit">Send inn p√•melding</button>
                    </form>
                </div>

            </div>

        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section">
        <div class="container">
            <h2 class="section-title">Kontakt</h2>
            <p style="text-align:center; font-size:1.1rem; color:#555;">
                Har du sp√∏rsm√•l om turneringa eller p√•melding?<br>
                Send oss gjerne ei melding p√• Instagram ‚Äì vi svarar fortast der üëá
            </p>
        </div>
    </section>

    <section class="instagram-cta">
        <div class="container">
            <a href="https://www.instagram.com/gingersummer_invitational/" target="_blank" class="instagram-cta-link">

                <svg class="ig-logo" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M7 2C4.243 2 2 4.243 2 7v10c0 2.757 2.243 5 5 5h10c2.757 
                    0 5-2.243 5-5V7c0-2.757-2.243-5-5-5H7zm10 2a3 3 0 
                    0 1 3 3v10a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 
                    0 1 3-3h10zm-5 3a5 5 0 1 0 0 10 5 5 0 
                    0 0 0-10zm0 2a3 3 0 1 1 0 6 3 3 0 
                    0 1 0-6zm4.5-3a1.5 1.5 0 1 0 0 3 1.5 1.5 0 
                    0 0 0-3z">
                    </path>
                </svg>

                F√∏lg oss p√• Instagram!
            </a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="logo_transparent.png" alt="Ginger Summer Invitational">
                </div>
                <div class="footer-info">
                    <p>&copy; 2025 Ginger Summer Invitational</p>
                </div>
                <div class="footer-links">
                    <a href="#top">Heim</a>
                    <a href="#tournament">Turnering</a>
                    <a href="#signup">P√•melding</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Success / Loading Popup -->
    <div id="successPopup" class="success-popup">
        <div class="success-popup-box">
            <div class="success-icon"></div>
            <p class="success-message">Sender p√•meldinga...</p>
            <button id="closePopup" class="btn-submit" style="margin-top:0; display:none;">Lukk</button>
        </div>
    </div>

    <!-- JS: send form with fetch to Apps Script and show popup -->
    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxgJTDLi6bojObUWZHRSo6BgSVeY6U6jjwtjCg9J-1zg1OsucGWQIxB4Z0gsVgny8Yy/exec';

        const form = document.getElementById('signupForm');
        const popup = document.getElementById('successPopup');
        const closePopupBtn = document.getElementById('closePopup');
        const popupBox = popup ? popup.querySelector('.success-popup-box') : null;
        const popupIcon = popup ? popup.querySelector('.success-icon') : null;
        const popupMsg = popup ? popup.querySelector('.success-message') : null;
        const submitBtn = form ? form.querySelector('.btn-submit') : null;

        function showLoadingState() {
            if (!popup || !popupBox || !popupIcon || !popupMsg) return;

            popup.classList.add('visible');
            popupBox.classList.add('loading');

            // Spinner (no text in icon)
            popupIcon.textContent = '';
            // Loading text
            popupMsg.textContent = 'Sender p√•meldinga...';

            if (closePopupBtn) {
                closePopupBtn.style.display = 'none';
            }
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Sender...';
            }
        }

        function showSuccessState() {
            if (!popupBox || !popupIcon || !popupMsg) return;

            popupBox.classList.remove('loading');
            popupIcon.textContent = '‚úî';
            popupMsg.textContent = 'Takk for p√•meldinga! Laget er registrert.';

            if (closePopupBtn) {
                closePopupBtn.style.display = 'inline-block';
            }
            if (submitBtn) {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Send inn p√•melding';
            }
        }

        if (form) {
            form.addEventListener('submit', function (e) {
                e.preventDefault();

                const formData = new FormData(form);

                // Vis popup med loading med ein gong
                showLoadingState();

                fetch(scriptURL, {
                    method: 'POST',
                    body: formData,
                    mode: 'no-cors'
                })
                    .then(() => {
                        form.reset();
                        showSuccessState();

                        // Oppdater ledige plassar etter p√•melding
                        if (typeof updateSpotsLeft === 'function') {
                            updateSpotsLeft();
                        }
                    })
                    .catch(() => {
                        // Sj√∏lv om noko feilar, vis success-tekst (du kan evt. endre til feilmelding her)
                        showSuccessState();

                        if (typeof updateSpotsLeft === 'function') {
                            updateSpotsLeft();
                        }
                    });
            });
        }

        if (closePopupBtn && popup) {
            closePopupBtn.addEventListener('click', () => {
                popup.classList.remove('visible');
            });

            popup.addEventListener('click', (e) => {
                if (e.target === popup) {
                    popup.classList.remove('visible');
                }
            });
        }
    </script>

    <script src="main.js"></script>
</body>

</html>
